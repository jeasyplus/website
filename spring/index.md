# Spring框架


## Spring框架初始化过程

Spring框架的初始化过程可以分为以下几个主要步骤：

+ **加载配置：**
   
    Spring框架首先会根据配置文件（如XML配置文件、注解等）加载应用程序的配置信息。这些配置文件定义了Bean的定义、依赖关系、AOP切面等。

+ **创建容器：**
  
    在加载配置后，Spring会创建一个应用程序上下文（ApplicationContext）或者一个Spring容器，它负责管理和协调应用程序中的所有Bean和组件。

+ **实例化Bean：**

    在容器创建后，Spring根据配置文件中的定义和注解信息，实例化各个Bean对象。Spring使用反射机制实例化Bean，并将其加入到容器中。

+ **注入依赖：**

    一旦Bean实例化，Spring会检查Bean之间的依赖关系，并将依赖关系注入到相应的Bean中。这可以通过构造函数注入、Setter方法注入或者自动装配（Autowired）等方式来完成。

+ **处理Bean的生命周期：**

    Spring容器会管理Bean的整个生命周期。它会调用Bean的初始化方法（如InitializingBean接口的afterPropertiesSet方法、@PostConstruct注解标注的方法等），并在容器关闭时调用Bean的销毁方法（如DisposableBean接口的destroy方法、@PreDestroy注解标注的方法等）。

+ **提供Bean：**

    一旦所有的Bean都被实例化、依赖注入和生命周期处理完毕，它们就可以被应用程序的其他组件使用了。Spring容器会提供相应的方法，使应用程序能够获取需要的Bean对象。

+ **AOP代理：** 

    如果应用程序使用了AOP（面向切面编程），Spring会根据AOP的配置创建相应的代理对象，并将其与原始Bean对象关联起来。这样，当调用原始Bean时，AOP代理会在适当的时机执行相应的切面逻辑。


## Spring AOT

Spring AOT（Ahead-of-Time Compilation）是Spring框架的一个功能，用于通过提前编译生成本机代码，以改善应用程序的启动时间和性能。

传统的Java应用程序在运行时使用即时编译（Just-in-Time Compilation，JIT）将字节码转换为机器码。

Spring AOT可以获得以下好处：

快速启动时间：通过提前编译生成本机代码，减少了JIT编译的时间延迟，从而加快应用程序的启动时间。

减少内存使用：本机代码通常比解释执行的字节码更紧凑，可以减少内存的占用。

更好的性能：通过静态编译和优化，可以提高应用程序的性能，并减少运行时的性能波动。

需要注意的是，Spring AOT在一些方面有限制和注意事项。由于提前编译的特性，一些动态特性（如动态代理、动态代码生成等）可能会受到限制。此外，每次应用程序更新时都需要重新构建和部署生成的本机代码。

## spring事务传播机制

Spring框架提供了一套事务管理机制，其中的事务传播机制用于定义在多个事务操作嵌套调用时，事务如何传播和协调的规则。

Spring的事务传播机制包括以下几种传播行为：

**REQUIRED（默认）：**

如果当前存在事务，则加入到当前事务中执行，如果没有事务，则创建一个新的事务执行。这是最常用的传播行为，确保所有操作在同一个事务中执行。

**SUPPORTS：**

如果当前存在事务，则加入到当前事务中执行，如果没有事务，则以非事务方式执行。适用于非关键的操作，可以在事务中执行，也可以在非事务中执行。

**MANDATORY：**

要求当前必须存在事务，否则抛出异常。适用于需要强制在事务中执行的操作。

**REQUIRES_NEW：**

无论当前是否存在事务，都创建一个新的事务执行。如果当前存在事务，则将当前事务挂起，并创建一个新的事务执行。适用于需要独立事务执行的操作。

**NOT_SUPPORTED：**

以非事务方式执行操作，如果当前存在事务，则将当前事务挂起。适用于不需要事务支持的操作。

**NEVER：**

禁止在当前事务中执行操作，如果当前存在事务，则抛出异常。适用于需要禁止事务的操作。

**NESTED：**

如果当前存在事务，则在当前事务的嵌套事务中执行。嵌套事务是外部事务的一部分，有自己的保存点，可以单独提交或回滚。如果当前没有事务，则创建一个新的事务执行。适用于需要独立的嵌套事务的操作。

## @Autowired 和 @Resource区别

它们可以用于自动装配Bean之间的依赖关系。尽管它们的目的相似，但在使用和行为上存在一些区别：

来源和支持的注入方式：

+ @Autowired 是Spring框架提供的注解，支持通过类型匹配进行依赖注入。它可以用于字段、构造函数、Setter方法和方法参数上。
+ @Resource 是Java EE规范中定义的注解，支持通过名称匹配进行依赖注入。它可以用于字段、Setter方法和方法参数上。
注入方式：

+ @Autowired 默认按照类型（byType）进行注入，如果找到多个匹配的Bean，则会尝试按照名称（byName）进行注入。
+ @Resource 默认按照名称（byName）进行注入，如果找不到对应名称的Bean，则按照类型（byType）进行注入。
限定符（Qualifier）：

+ @Autowired 可以与 @Qualifier 注解结合使用，用于指定要注入的Bean的限定符，以区分同类型的多个Bean。
+ @Resource 本身就支持对Bean的限定符进行注入，无需额外的 @Qualifier 注解。
支持的注入类型：

+ @Autowired 可以用于自动装配Spring容器中的任何Bean，包括自定义Bean、第三方库的Bean等。
+ @Resource 主要用于注入Java EE环境中的资源（Resource），如JDBC DataSource、JMS ConnectionFactory等。它也可以注入Spring容器中的Bean，但在类型匹配时稍显限制。



[SpringCloud](https://jeasyplus.com/spring/cloud)




