# 线性回归
长久以来，人们都知道板球（昆虫物种）在天气炎热的日子里会比在更冷的日子里鸣叫。

数十年来，专业和业余科学家一直在编制每分钟的鸣叫声和温度方面的数据。

首先，通过绘制数据的方式检查数据：

![鸣叫声和温度方面的数据](https://jeasyplus.com/images/machine-learning/2023-06-2616.40.03.png)

__图 1. 每分钟的鸣叫声与温度（以摄氏度为单位）。__

如您所料，该图表显示了温度随着鸣叫声次数的增加而上升。 

鸣叫声与温度之间的关系是线性关系吗？

可以，您可以绘制一条直线来大致说明这种关系：

![每分钟的鸣叫声与温度](https://jeasyplus.com/images/machine-learning/2023-06-26-16.42.29.png)

__图 2. 一种线性关系。__

没错，虽然这个直线并未穿过每一个点，但清晰地显示了鸣叫声和温度之间的关系。
使用直线的等式，您可以写出这种关系，如下所示：

![图](https://jeasyplus.com/images/machine-learning/2023-06-26-16.45.00.png)

其中：

+ **y**是摄氏度，即我们正在尝试预测的值。
+ __m__ 是直线的斜率。
+ __x__ 是每分钟的鸣叫声次数，即输入特征的值。
+ __b__ 是 y 轴截距。

按照机器学习的惯例，您为模型算式的过程会略有不同：
![图](https://jeasyplus.com/images/machine-learning/2023-06-26-16.47.17.png)

其中：

+ __y`__ 是预测的标签（理想输出）。
+ __b__ 是偏差（y 轴截距），有时称为w0。
+ __w1__ 是特征 1 的权重。权重与传统线方程中的“斜率”__m__ 概念相同。
+ __x1__ 是一项功能（已知输入）。

如需根据新的每分钟的鸣叫声值 __y`__ 推断温度，只需将 __x1__ 值替换为此模型即可。

__y`x1x1__ 虽然此模型仅使用一个特征，但更复杂的模型可能依赖于多个特征，每个特征都有单独的权重（w1、w2 等）。

例如，一个依赖于三个特征的模型可能如下所示：
![图](https://jeasyplus.com/images/machine-learning/2023-06-26-16.52.48.png)


## 训练和损失

训练模型只需从有标签样本中学习（确定）所有权重和偏差的理想值。

在监督式学习中，机器学习算法通过检查许多示例并尝试找到将损失降至最低的模型来构建模型；此过程称为 __经验风险最小化__。

__经验风险__ 是指在训练数据上计算出的模型预测与实际标签之间的差异。

我们希望找到能够**最小化**这种差异的模型。为了实现这一点，我们需要选择一个模型和一个合适的损失函数。

**经验风险最小化**的目标就是通过选择适当的模型参数，使得在训练数据上的平均损失最小化。

为了评估模型在未见过的数据上的表现，我们通常会将数据分成训练集和测试集。经过训练的模型会在训练集上表现良好，但我们还需要通过在测试集上的表现来验证其泛化能力。

经验风险最小化是机器学习中常见的一种训练方法，它致力于在训练数据上寻找最佳模型参数，以期望在未知数据上获得较好的性能。


损失是错误预测的惩罚。也就是说，损失是一个表示模型在单个样本上的预测质量的数字。

如果模型的预测完全准确，则损失为零，否则损失会更大。训练模型的目的是从所有样本中找到一组平均损失“较小”的权重和偏差。

例如，图 3 左侧显示的是高损失模型，右侧显示的是低损失模型。对于该图，请注意以下几点：

+ 箭头表示损失。
+ 蓝线表示预测。

**图 3. 左侧模型中的损失较高；右侧模型中的损失较低。**

![图](https://jeasyplus.com/images/machine-learning/2023-06-26-17.23.51.png)

请注意，左侧曲线图中的箭头比右侧曲线图中的箭头长得多。

显然，相较于左侧曲线图中的线条，右侧曲线图中的预测模型要好得多。

您可能想知道是否可以创建数学函数（损失函数），以有意义的方式汇总各个损失。

### 平方损失函数：一种常用的损失函数

我们在此探讨的线性回归模型使用一种称为平方损失函数（也称为 L2 损失）的损失函数。单个样本的平方损失如下：
```python
  = the square of the difference between the label and the prediction
  = (observation - prediction(x))2
  = (y - y')2
```
均方误差 (MSE) 是指整个数据集中每个样本的平均平方损失。如需计算 MSE，请先计算各个样本的所有平方损失之和，然后除以样本数量：

![图](https://jeasyplus.com/images/machine-learning/2023-06-26-17.26.16.png)

其中：
+   **(x,y)** 是一个示例，其中
    **x** 是模型用于进行预测的特征集（例如，每分钟的鸣叫次数、年龄、性别）。

+   **y** 是示例标签（例如，温度）。
+    **prediction(x)** 是权重和偏差与一组特征的组合x。
+    **D** 是一个包含许多有标签样本（成对）的数据集。(x,y)
+ **N** 是 **D** 中的样本数。

  虽然 MSE 常用于机器学习，但它既不是唯一实用的损失函数，也不是适用于所有情况的最佳损失函数。

## 训练
![图](https://jeasyplus.com/images/machine-learning/2023-06-26-17.33.53.png)

![图](https://jeasyplus.com/images/machine-learning/2023-06-26-17.50.37.png)





