# 训练集和测试集

**不要用测试数据集进行训练**


![图](https://jeasyplus.com/images/machine-learning/2023-06-27-18.36.51.svg)

### 如果我们只有一个数据集，该怎么办？

分为两组：
+ 训练集

+ 测试集

  **经典陷阱：请勿对测试数据进行训练**
+ 损失极低？


+ 在庆祝之前，请检查是否意外使用了测试数据进行训练

## 训练集和测试集：拆分数据


+ 训练集 - 用于训练模型的子集。


+ 测试集 - 用于测试训练后模型的子集。

您可以拆分单个数据集，如下所示：

![图](https://jeasyplus.com/images/machine-learning/2023-06-27-18.39.51.svg)

**图 1. 将单个数据集拆分为训练集和测试集。**

+ 确保您的测试集满足以下两个条件：


+ 规模足以产生具有统计意义的结果。


可代表整个数据集。换言之，不要选择特征与训练集不同的测试集。


假设您的测试集满足上述两个条件，您的目标是创建一个能够很好地泛化到新数据的模型。我们的测试集充当新数据的代理。

请参考下图。请注意，为训练数据学习的模型非常简单。此模型无法做到完美 - 一些预测是错误的。

不过，该模型在测试数据上的表现与在训练数据上大致相同。换句话说，这个简单的模型不会过拟合训练数据。

![图](https://jeasyplus.com/images/machine-learning/2023-06-27-18.41.03.svg)

**图 2. 根据测试数据验证经过训练的模型。**

切勿基于测试数据进行训练。如果您在评估指标上发现出乎意料地良好结果，则可能表明您不小心对测试集进行了训练。例如，高准确率可能表示测试数据已泄露到训练集中。

例如，假设某个模型使用主题行、电子邮件正文和发件人的电子邮件地址来预测电子邮件是否为垃圾邮件。


我们会将数据划分为 80-20 的训练集和测试集。训练完成后，该模型在训练集和测试集上的准确率都达到 99%。

我们预计测试集的准确率会较低，因此我们会再次查看数据，发现测试集中的许多样本与训练集中的样本重复（在拆分数据之前，我们忽略了输入数据库中同一垃圾电子邮件的重复条目）。

我们无意中对一些测试数据进行了训练，因此无法再准确衡量模型泛化到新数据的效果。


![图](https://jeasyplus.com/images/machine-learning/2023-06-27-18.57.38.png)
