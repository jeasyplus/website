# JVM如何创建对象

## 检查指令参数

检查**指令参数**是否能在**常量池**定位到类的符号引用。并检查符号引用代表的类是否已完成加载、解析和初始化。

如果没有，则先执行[类的初始化过程](https://jeasyplus.com/java/class)。

## 分配内存

对象的内存分配有两种方式：

+ 指针碰撞：当堆内存是连续的，JVM使用一个指针标记内存可用的位置，根据对象大小向后移动指针。
+ 空闲列表法：当堆内存是离散的，JVM维护一个空闲列表，记录可用的内存块。根据对象大小找出合适的内存块。

内存分配并发问题解决的两种手段：1、CAS+失败重试；2、TLAB(在堆内存中为每个线程预先分配的一块小的私有空间)

## 初始化

内存分配完成后，JVM会将分配的空间初始化为**零值**，确保对象的字段都有明确的值（如：int=0,object=null）

## 设置对象头

对象所对应的Class，对象的hashCode，对象的GC分代年龄，轻量级锁。

## 调用构造方法

使用构造方法初始化对象。

## 返回对象引用

对象创建完成，返回一个该对象的引用。












